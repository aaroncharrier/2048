This is the rough script I started with. There may be a few bugs in the direction functions.
